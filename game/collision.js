"use strict";

// This is cheap spherical billboarding
mat4.flattenSpherically = function(out, a)
{
    out[0] = 1;
    out[1] = 0;
    out[2] = 0;
    out[3] = a[3];
    out[4] = 0;
    out[5] = 1;
    out[6] = 0;
    out[7] = a[7];
    out[8] = 0;
    out[9] = 0;
    out[10] = 1;
    out[11] = a[11];
    out[12] = a[12];
    out[13] = a[13];
    out[14] = a[14];
    out[15] = a[15];
    return out;
};

function radiansFromDegrees(degrees)
{
	return degrees * Math.PI / 180.0;
}

function CollisionArena(gl)
{
	var wallTexture = new Image();
	wallTexture.bindTexture = gl.createTexture();
	//wallTexture.src = "data/wall.jpg";
	// Images don't load locally so I created them with command line: "base64 -i mypicture.jpg -o mypicture.txt" and "data:image/jpg;base64,"
	// Below runs slower in a compiled application
	wallTexture.src = "data:image/jpg;base64,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";
	
	wallTexture.addEventListener("load", function()
	{
		gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);  // Flip the image Y coordinate
		gl.bindTexture(gl.TEXTURE_2D, wallTexture.bindTexture);
		gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, wallTexture);

		// Use gl.CLAMP_TO_EDGE for non power of 2 images
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);
		// NEAREST_MIPMAP_LINEAR is the default and GL_LINEAR_MIPMAP_NEAREST is faster than GL_LINEAR_MIPMAP_LINEAR
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST_MIPMAP_LINEAR);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
		
		gl.generateMipmap(gl.TEXTURE_2D);
	}, false);

	var grassTexture = new Image();
	grassTexture.bindTexture = gl.createTexture();
	//grassTexture.src = "data/grass.jpg";
	// Images don't load locally so I created them with command line: "base64 -i mypicture.jpg -o mypicture.txt" and "data:image/jpg;base64,"
	// Below runs slower in a compiled application
	grassTexture.src = "data:image/jpg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QC6RXhpZgAATU0AKgAAAAgABwEGAAMAAAABAAIAAAEOAAIAAAAWAAAAYgESAAMAAAABAAEAAAEaAAUAAAABAAAAeAEbAAUAAAABAAAAgAEoAAMAAAABAAIAAIdpAAQAAAABAAAAiAAAAABDcmVhdGVkIHdpdGggVGhlIEdJTVAAAAAASAAAAAEAAABIAAAAAQADoAEAAwAAAAEAAQAAoAIABAAAAAEAAACAoAMABAAAAAEAAACAAAAAAP/hCdNodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4gPGRjOmRlc2NyaXB0aW9uPiA8cmRmOkFsdD4gPHJkZjpsaSB4bWw6bGFuZz0ieC1kZWZhdWx0Ij5DcmVhdGVkIHdpdGggVGhlIEdJTVA8L3JkZjpsaT4gPC9yZGY6QWx0PiA8L2RjOmRlc2NyaXB0aW9uPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg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";
	
	grassTexture.addEventListener("load", function()
	{
		gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);  // Flip the image Y coordinate
		gl.bindTexture(gl.TEXTURE_2D, grassTexture.bindTexture);
		gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, grassTexture);

		// Use gl.CLAMP_TO_EDGE for non power of 2 images
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);
		// NEAREST_MIPMAP_LINEAR is the default and GL_LINEAR_MIPMAP_NEAREST is faster than GL_LINEAR_MIPMAP_LINEAR
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST_MIPMAP_LINEAR);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
		
		gl.generateMipmap(gl.TEXTURE_2D);
	}, false);
	
	this.levelSound = new Audio("data/level.mp3");
	this.waterSound = new Audio("data/waterdrop.mp3");
	this.rockSound = new Audio("data/destroy.mp3");
	
	var levelNumberText = document.getElementById("LevelNumber");
	levelNumberText.style.display = "none";
	
	this.spaceship = new Spaceship(gl);
	this.grass = new Grass(gl, grassTexture);
	this.wall = new Wall(gl, wallTexture);
	this.waterBlastArray = [];
	this.rockArray = [];
	this.showCollision = false;
	this.scoreNumberText = document.getElementById("ScoreNumber");
	this.waterBlastTime = 1;
	this.fireWaterBlast = false;
	this.levelStartTimer = 0;
	
	self = this;
	
	// This shows the collision polygons
	window.addEventListener("keydown", function(event)
	{
		var levelNumberText;
		
		if (event.keyCode === 76) // l key
		{
			self.showCollision = !self.showCollision;
		}
		else if (event.keyCode === 32) // Spacebar
		{
			if (self.fireWaterBlast === false && self.waterBlastTime > 0.05)
			{
				self.waterBlastTime = 0;
				self.waterBlastArray.push(new WaterBlast(gl, self.spaceship.position, self.spaceship.angleDegrees));
			
				self.waterSound.currentTime = 0;
				self.waterSound.play();
			}

			self.fireWaterBlast = true;
		}
		
		if (ARENA.levelScreen === true && self.levelStartTimer >= 0.5 && ARENA.levelNumber > -1)
		{
			levelNumberText = document.getElementById("LevelNumber");

			if (levelNumberText.style.display === "block")
			{
				levelNumberText.style.display = "none";
				
				self.createNewLevel(gl, ARENA.levelNumber);
				ARENA.levelScreen = false;
				self.levelStartTimer = 0;
			}
		}
	}, false);
	
	window.addEventListener("keyup", function(event)
	{
		if (event.keyCode === 32) // Spacebar
		{
			self.fireWaterBlast = false;
			self.waterBlastTime = 1;
		}
	}, false);
}

CollisionArena.prototype.createNewLevel = function(gl, levelNumber)
{
	this.spaceship.active = true;

	if (levelNumber === 1)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:0, y:20, z:0}, 0));
	}
	else if (levelNumber === 2)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:20, z:0}, 0));
	}
	else if (levelNumber === 3)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:  0, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:20, z:0}, 0));
	}
	else if (levelNumber === 4)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y: 0, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y: 0, z:0}, 0));
	}
	else if (levelNumber === 5)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:  0, y:20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y: 0, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y: 0, z:0}, 0));
	}
	else if (levelNumber === 6)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y: 20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y: 20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y: 0,  z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y: 0,  z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:-20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:-20, z:0}, 0));
	}
	else if (levelNumber === 7)
	{
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y: 20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y: 20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:  0, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:  0, y: 20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:  0, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x:-20, y:-20, z:0}, 0));
		this.rockArray.push(new Rock(gl, "Large", {x: 20, y:-20, z:0}, 0));
	}
}

CollisionArena.prototype.update = function(gl, world, shaderProgram, projectionMatrix, timeStep)
{
	var newRocksArray = [];
	var levelNumberText;
	var waterBlast;
	var velocity;
	var rock;
	var rock2;
	var index1;
	var index2;
	var index3;
	
	this.spaceship.position = {x:world.position.x, y:world.position.y, z:0};
	this.spaceship.angleDegrees = {x:0, y:0, z:world.angleDegrees.z};
	this.rockAddLaterArray = [];
	
	if (this.fireWaterBlast === true)
	{
		if (this.waterBlastTime > 0.4)
		{
			this.waterBlastArray.push(new WaterBlast(gl, this.spaceship.position, this.spaceship.angleDegrees));
			this.waterBlastTime = 0;

			this.waterSound.currentTime = 0;
			this.waterSound.play();
		}
		else
		{
			this.waterBlastTime += timeStep;
		}
	}
	
	// Create our walls
	var outsideWallTop =
	{
		start:{x:-40, y:40, z:0},
		end:{x:40, y:40, z:0}
	};
	
	var outsideWallBottom =
	{
		start:{x:-40, y:-40, z:0},
		end:{x:40, y:-40, z:0}
	};
	
	var outsideWallRight =
	{
		start:{x:40, y:40, z:0},
		end:{x:40, y:-40, z:0}
	};
	
	var outsideWallLeft =
	{
		start:{x:-40, y:40, z:0},
		end:{x:-40, y:-40, z:0}
	};

	// Wall to spaceship collision
	if (checkLineToCircleCollision(outsideWallRight, this.spaceship))
	{
		this.spaceship.position.x = outsideWallRight.start.x - this.spaceship.radius;
		world.position.x = this.spaceship.position.x;
	}
	
	if (checkLineToCircleCollision(outsideWallLeft, this.spaceship))
	{
		this.spaceship.position.x = outsideWallLeft.start.x + this.spaceship.radius;
		world.position.x = this.spaceship.position.x;
	}
	
	if (checkLineToCircleCollision(outsideWallTop, this.spaceship))
	{
		this.spaceship.position.y = outsideWallTop.start.y - this.spaceship.radius;
		world.position.y = this.spaceship.position.y;
	}
	
	if (checkLineToCircleCollision(outsideWallBottom, this.spaceship))
	{
		this.spaceship.position.y = outsideWallBottom.start.y + this.spaceship.radius;
		world.position.y = this.spaceship.position.y;
	}
	
	// Update the rock motion
	for (index1 = 0; index1 < this.rockArray.length; index1++)
	{
		rock = this.rockArray[index1];
		
		rock.position.x += rock.velocity.x * timeStep;
		rock.position.y += rock.velocity.y * timeStep;
		rock.position.z += rock.velocity.z * timeStep;
		
		rock.angleDegrees.x += rock.angularVelocity.x * timeStep;
		rock.angleDegrees.y += rock.angularVelocity.y * timeStep;
		rock.angleDegrees.z += rock.angularVelocity.z * timeStep;
	}
	
	// Check rock and spaceship collisions
	for (index1 = 0; index1 < this.rockArray.length; index1++)
	{
		rock = this.rockArray[index1];
		
		// Wall to rock collision
		if (checkLineToCircleCollision(outsideWallRight, rock))
		{
			rock.velocity.x = -rock.velocity.x;
		}
		
		if (checkLineToCircleCollision(outsideWallLeft, rock))
		{
			
			rock.velocity.x = -rock.velocity.x;
		}

		if (checkLineToCircleCollision(outsideWallTop, rock))
		{
			
			rock.velocity.y = -rock.velocity.y;
		}
		
		if (checkLineToCircleCollision(outsideWallBottom, rock))
		{
			rock.velocity.y = -rock.velocity.y;
		}

		if (rock.position.x > outsideWallRight.start.x - rock.radius)
		{
			rock.position.x = outsideWallRight.start.x - rock.radius;
		}

		if (rock.position.x < outsideWallLeft.start.x + rock.radius)
		{
			rock.position.x = outsideWallLeft.start.x + rock.radius;
		}

		if (rock.position.y > outsideWallTop.start.y - rock.radius)
		{
			rock.position.y = outsideWallTop.start.y - rock.radius;
		}
		
		if (rock.position.y < outsideWallBottom.start.y + rock.radius)
		{
			rock.position.y = outsideWallBottom.start.y + rock.radius;
		}
		
		// Spaceship to rock collision
		if (checkCircleToCircleCollision(this.spaceship, rock))
		{
			if (rock.active === true)
			{
				if (rock.size === "Large")
				{
					for (index2 = 0; index2 < 3; index2++)
					{
						this.rockArray.push(new Rock(gl, "Medium", rock.position, index2));
					}
				}
				else if (rock.size === "Medium")
				{
					for (index2 = 0; index2 < 3; index2++)
					{
						this.rockArray.push(new Rock(gl, "Small", rock.position, index2));
					}
				}
				
				rock.active = false;
			}
			
			this.spaceship.active = false;
		}
		
		for (index2 = 0; index2 < this.rockArray.length; index2++)
		{
			rock2 = this.rockArray[index2];
		
			if (checkCircleToCircleCollision(rock2, rock) && rock2 !== rock)
			{
				if (rock.active == true)
				{
					if (rock.size === "Large")
					{
						for (index3 = 0; index3 < 3; index3++)
						{
							this.rockAddLaterArray.push(new Rock(gl, "Medium", rock.position, index3));
						}
					}
					else if (rock.size === "Medium")
					{
						for (index3 = 0; index3 < 3; index3++)
						{
							this.rockAddLaterArray.push(new Rock(gl, "Small", rock.position, index3));
						}
					}
				
					rock.active = false;
				}
			}
		}
	}
	
	// update water the motion
	for (index1 = 0; index1 < this.waterBlastArray.length; index1++)
	{
		waterBlast = this.waterBlastArray[index1];
		
		velocity = vectorFromAngleAndVector(waterBlast.angleDegrees, {x:0, y:55, z:0});

		waterBlast.position.x += velocity.x * timeStep;
		waterBlast.position.y += velocity.y * timeStep;
		waterBlast.position.z += velocity.z * timeStep;
	}

	// Check water collisions
	for (index1 = 0; index1 < this.waterBlastArray.length; index1++)
	{
		waterBlast = this.waterBlastArray[index1];
		
		// Wall to Water Blast
		if (40 < waterBlast.position.x - waterBlast.radius // right wall
			|| -40 > waterBlast.position.x + waterBlast.radius // left wall
			||  40 < waterBlast.position.y - waterBlast.radius // top wall
			|| -40 > waterBlast.position.y + waterBlast.radius) // bottom wall
		{
			//this.waterBlastArray.splice(index1, 1);
			waterBlast.active = false;
		}

		// Water Blast to rock collision
		for (index2 = 0; index2 < this.rockArray.length; index2++)
		{
			rock = this.rockArray[index2];
			
			if (checkCircleToCircleCollision(waterBlast, rock))
			{
				if (rock.active === true)
				{
					if (rock.size === "Large")
					{
						this.scoreNumberText.innerHTML = parseInt(this.scoreNumberText.innerHTML) + 5;
						
						for (index3 = 0; index3 < 3; index3++)
						{
							this.rockAddLaterArray.push(new Rock(gl, "Medium", rock.position, index3));
						}
					}
					else if (rock.size === "Medium")
					{
						this.scoreNumberText.innerHTML = parseInt(this.scoreNumberText.innerHTML) + 3;
						
						for (index3 = 0; index3 < 3; index3++)
						{
							this.rockAddLaterArray.push(new Rock(gl, "Small", rock.position, index3));
						}
					}
					else if (rock.size === "Small")
					{
						this.scoreNumberText.innerHTML = parseInt(this.scoreNumberText.innerHTML) + 1;
					}
					
					rock.active = false;
				}
				
				waterBlast.active = false;
			}
		}
	}
	
	// Destroy the water blasts if they have hit something
	for (index1 = this.waterBlastArray.length - 1; index1 >= 0; index1--)
	{
		waterBlast = this.waterBlastArray[index1];
		
		if (waterBlast.active === false)
		{
			this.waterBlastArray.splice(index1, 1);
		}
	}

	// Destroy the rocks that had a collision
	for (index1 = this.rockArray.length - 1; index1 >= 0; index1--)
	{
		rock = this.rockArray[index1];
		
		if (rock.active === false)
		{
			this.rockArray.splice(index1, 1);
			
			this.rockSound.currentTime = 0;
			this.rockSound.play();
		}
	}
	
	// Add any new rocks after the old ones have been destroyed
	for (index1 = 0; index1 < this.rockAddLaterArray.length; index1++)
	{
		this.rockArray.push(this.rockAddLaterArray[index1]);
	}
	
	// Update and draw the spaceship, grass, wall, rocks, and water
	this.spaceship.updateGraphics(gl, world, shaderProgram, projectionMatrix, this.showCollision);
	this.grass.updateGraphics(gl, world, shaderProgram, projectionMatrix);
	this.wall.updateGraphics(gl, world, shaderProgram, projectionMatrix);
	
	for (index1 = 0; index1 < this.rockArray.length; index1++)
	{
		rock = this.rockArray[index1];
		rock.updateGraphics(gl, world, shaderProgram, projectionMatrix, this.showCollision);
	}
	
	for (index1 = 0; index1 < this.waterBlastArray.length; index1++)
	{
		waterBlast = this.waterBlastArray[index1];
		waterBlast.updateGraphics(gl, world, shaderProgram, projectionMatrix, timeStep, this.showCollision);
	}
	
	// If the level number is -1 then the game is finished and the player has won
	if (ARENA.levelNumber > -1)
	{
		// The spaceshipe hit a rock so go back one level and erase the score
		if (this.spaceship.active === false && ARENA.levelScreen === false)
		{
			if (ARENA.levelNumber > 1)
			{
				ARENA.levelNumber--;
			}

			this.scoreNumberText.innerHTML = "0";
			ARENA.levelScreen = true;
		}
		// All of the rocks have been hit so it is time to go to the next level
		else if (this.rockArray.length <= 0 && ARENA.levelScreen === false)
		{
			if (ARENA.levelNumber <= 7)
			{
				ARENA.levelNumber++;
			}
			
			ARENA.levelScreen = true;
		}
	}
	
	if (ARENA.levelScreen === true)
	{
		levelNumberText = document.getElementById("LevelNumber");
		
		this.levelStartTimer += timeStep;
		
		if (levelNumberText.style.display === "none")
		{
			// Create the next level
			if (ARENA.levelNumber <= 7 && ARENA.levelNumber > -1)
			{
				// Remove all of the old rocks and water blasts before the level starts
				this.rockArray = [];
				this.waterBlastArray = [];
				
				levelNumberText.innerHTML = "Level " + ARENA.levelNumber;
				levelNumberText.style.display = "block";
				
				this.levelSound.currentTime = 0;
				this.levelSound.play();
			}
			// The game has been won
			else
			{
				levelNumberText.innerHTML = "You Won!";
				levelNumberText.style.display = "block";
				ARENA.levelNumber = -1;
				
				this.levelSound.currentTime = 0;
				this.levelSound.play();
			}
		}
	}
}

function Spaceship(gl)
{
	// bottom
	this.spaceshipBottom = createCylinder(gl, 0.5, 0, 1, 8, 1);
	// Antenna
	this.spaceshipAntenna = createCylinder(gl, 1.1, 0, 0.1, 6, 10);
	this.radius = 1;
	this.collision = createRoundedSquare(gl, this.radius + 0.5);
	this.position = {x:0, y: 0, z:0};
	this.angleDegrees = {x:0, y:0, z:0};
	this.active = true;
}

Spaceship.prototype.updateGraphics = function(gl, world, shaderProgram, projectionMatrix, showCollision)
{
	var modelViewProjectionMatrix = mat4.create();
	var modelViewMatrix = mat4.create();
	var rotationMatrix = mat4.create();
	
// Spaceship bottom
	gl.enableVertexAttribArray(shaderProgram.a_Position);
	gl.enableVertexAttribArray(shaderProgram.a_Normal);
	
	mat4.identity(modelViewMatrix);
	
	mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0,-15]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-65), [1, 0, 0]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-world.angleDegrees.z), [0, 0, 1]);
	
	mat4.rotate(rotationMatrix, modelViewMatrix, radiansFromDegrees( world.angleDegrees.z), [0, 0, 1]);
	mat4.translate(rotationMatrix, rotationMatrix, [0, 0, 0.25]);
	mat4.rotate(rotationMatrix, rotationMatrix, radiansFromDegrees(90), [1, 0, 0]);
	
	mat4.multiply(modelViewProjectionMatrix, projectionMatrix, rotationMatrix);
	
	gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
	gl.uniformMatrix4fv(shaderProgram.u_ModelViewMatrix, false, modelViewMatrix);
	gl.uniformMatrix4fv(shaderProgram.u_RotationMatrix, false, rotationMatrix);
	
	gl.uniform1f(shaderProgram.u_Radius, this.spaceshipBottom.radius);
	gl.uniform1i(shaderProgram.u_Lighting, this.spaceshipBottom.lighting);
	gl.uniform1i(shaderProgram.u_Texture, this.spaceshipBottom.texture);
	gl.uniform4f(shaderProgram.u_Color, 0.55, 0.55, 0.55, 1);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.spaceshipBottom.vertexBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.spaceshipBottom.normalBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Normal, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.spaceshipBottom.indexBuffer);
	gl.drawElements(gl.TRIANGLES, this.spaceshipBottom.indexLength, gl.UNSIGNED_SHORT, 0);

	//gl.disableVertexAttribArray(shaderProgram.a_Position);
	//gl.disableVertexAttribArray(shaderProgram.a_Normal);
	
// Spaceship Antenna
	//gl.enableVertexAttribArray(shaderProgram.a_Position);
	//gl.enableVertexAttribArray(shaderProgram.a_Normal);

	mat4.rotate(rotationMatrix, modelViewMatrix, radiansFromDegrees( world.angleDegrees.z), [0, 0, 1]);
	mat4.translate(rotationMatrix, rotationMatrix, [0, 0, 1]);
	mat4.rotate(rotationMatrix, rotationMatrix, radiansFromDegrees(90), [1, 0, 0]);
	
	mat4.multiply(modelViewProjectionMatrix, projectionMatrix, rotationMatrix);

	gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
	gl.uniformMatrix4fv(shaderProgram.u_RotationMatrix, false, rotationMatrix);

	gl.uniform1f(shaderProgram.u_Radius, this.spaceshipAntenna.radius);
	gl.uniform1i(shaderProgram.u_Lighting, this.spaceshipAntenna.lighting);
	gl.uniform1i(shaderProgram.u_Texture, this.spaceshipAntenna.texture);
	gl.uniform4f(shaderProgram.u_Color, 0.55, 0.55, 0.55, 1);

	gl.bindBuffer(gl.ARRAY_BUFFER, this.spaceshipAntenna.vertexBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.spaceshipAntenna.normalBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Normal, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.spaceshipAntenna.indexBuffer);
	gl.drawElements(gl.TRIANGLES, this.spaceshipAntenna.indexLength, gl.UNSIGNED_SHORT, 0);

	gl.disableVertexAttribArray(shaderProgram.a_Position);
	gl.disableVertexAttribArray(shaderProgram.a_Normal);
	
	if (showCollision)
	{
		gl.enableVertexAttribArray(shaderProgram.a_Position);
		gl.enableVertexAttribArray(shaderProgram.a_Color);

		mat4.multiply(modelViewProjectionMatrix, projectionMatrix, modelViewMatrix);

		gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
		gl.uniform1f(shaderProgram.u_Radius, this.radius);
		gl.uniform1i(shaderProgram.u_Lighting, false);
		gl.uniform1i(shaderProgram.u_Texture, false);
		gl.uniform4f(shaderProgram.u_Color, 0, 0, 1, 1);
	
		gl.bindBuffer(gl.ARRAY_BUFFER, this.collision.vertexBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
		gl.bindBuffer(gl.ARRAY_BUFFER, this.collision.colorBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Color, 4, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.collision.indexBuffer);
		gl.drawElements(gl.TRIANGLES, this.collision.indexLength, gl.UNSIGNED_SHORT, 0);
		
		gl.disableVertexAttribArray(shaderProgram.a_Position);
		gl.disableVertexAttribArray(shaderProgram.a_Color);
	}
}

function Grass(gl, grassTexture)
{
	this.grassObject = createGrass(gl);
	this.grassTexture = grassTexture;
}

Grass.prototype.updateGraphics = function(gl, world, shaderProgram, projectionMatrix)
{
	var modelViewProjectionMatrix = mat4.create();
	var modelViewMatrix = mat4.create();

	gl.enableVertexAttribArray(shaderProgram.a_Position);
	gl.enableVertexAttribArray(shaderProgram.a_Color);
	gl.enableVertexAttribArray(shaderProgram.a_TexCoord);
	
	mat4.identity(modelViewMatrix);
	
	mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0,-15]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-65), [1, 0, 0]);

	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-world.angleDegrees.z), [0, 0, 1]);
	mat4.translate(modelViewMatrix, modelViewMatrix, [-world.position.x,-world.position.y, 0]);
	
	mat4.multiply(modelViewProjectionMatrix, projectionMatrix, modelViewMatrix);
	
	gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
	gl.uniform1f(shaderProgram.u_Radius, this.grassObject.radius);
	gl.uniform1i(shaderProgram.u_Lighting, this.grassObject.lighting);
	gl.uniform1i(shaderProgram.u_Texture, this.grassObject.texture);
	gl.uniform1i(shaderProgram.u_Sampler, this.grassObject.sampler);

	gl.activeTexture(gl.TEXTURE0 + this.grassObject.sampler);
	gl.bindTexture(gl.TEXTURE_2D, this.grassTexture.bindTexture);

	gl.bindBuffer(gl.ARRAY_BUFFER, this.grassObject.textureBuffer);
	gl.vertexAttribPointer(shaderProgram.a_TexCoord, 2, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.grassObject.vertexBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.grassObject.colorBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Color, 4, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.grassObject.indexBuffer);
	gl.drawElements(gl.TRIANGLES, this.grassObject.indexLength, gl.UNSIGNED_SHORT, 0);
	
	gl.disableVertexAttribArray(shaderProgram.a_Position);
	gl.disableVertexAttribArray(shaderProgram.a_Color);
	gl.disableVertexAttribArray(shaderProgram.a_TexCoord);
}

function Wall(gl, wallTexture)
{
	this.wallObject = createWall(gl);
	this.wallTexture = wallTexture;
}

Wall.prototype.updateGraphics = function(gl, world, shaderProgram, projectionMatrix)
{
	var modelViewProjectionMatrix = mat4.create();
	var modelViewMatrix = mat4.create();
	// A different matrix is used for the four rock walls
	var wallViewMatrix = mat4.create();
	var index1;
	
	gl.enableVertexAttribArray(shaderProgram.a_Position);
	gl.enableVertexAttribArray(shaderProgram.a_Color);
	gl.enableVertexAttribArray(shaderProgram.a_TexCoord);
	
	mat4.identity(modelViewMatrix);
	
	mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0,-15]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-65), [1, 0, 0]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-world.angleDegrees.z), [0, 0, 1]);
	mat4.translate(modelViewMatrix, modelViewMatrix, [-world.position.x,-world.position.y, 0]);
	
	gl.uniform1f(shaderProgram.u_Radius, this.wallObject.radius);
	gl.uniform1i(shaderProgram.u_Lighting, this.wallObject.lighting);
	gl.uniform1i(shaderProgram.u_Texture, this.wallObject.texture);
	gl.uniform1i(shaderProgram.u_Sampler, this.wallObject.sampler);
	
	gl.activeTexture(gl.TEXTURE0 + this.wallObject.sampler);
	gl.bindTexture(gl.TEXTURE_2D, this.wallTexture.bindTexture);
	
	for (index1 = 0; index1 < 4; index1++)
	{
		mat4.rotate(wallViewMatrix, modelViewMatrix, radiansFromDegrees(90 * index1), [0, 0, 1]);
		mat4.translate(wallViewMatrix, wallViewMatrix, [0, 42.5, 0]);
		
		mat4.multiply(modelViewProjectionMatrix, projectionMatrix, wallViewMatrix);
		
		gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
		
		gl.bindBuffer(gl.ARRAY_BUFFER, this.wallObject.textureBuffer);
		gl.vertexAttribPointer(shaderProgram.a_TexCoord, 2, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ARRAY_BUFFER, this.wallObject.vertexBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ARRAY_BUFFER, this.wallObject.colorBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Color, 4, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.wallObject.indexBuffer);
		gl.drawElements(gl.TRIANGLES, this.wallObject.indexLength, gl.UNSIGNED_SHORT, 0);
	}
	
	gl.disableVertexAttribArray(shaderProgram.a_Position);
	gl.disableVertexAttribArray(shaderProgram.a_Color);
	gl.disableVertexAttribArray(shaderProgram.a_TexCoord);			
}

function Rock(gl, size, position, index1)
{
	var randomAngle;
	var newPosition;
	var velocity;
	
	if (size === "Large")
	{
		this.radius = 2;
	}
	else if (size === "Medium")
	{
		this.radius = 1.1;
	}
	else if (size === "Small")
	{
		this.radius = 0.6;
	}
	
	this.size = size;
	this.active = true;
	this.rockObject = createSphere(gl, 5, 4, this.radius);
	this.collision = createRoundedSquare(gl, this.radius + 0.5);

	if (size === "Large")
	{
		// random angle in degrees between 0 to 259
		randomAngle = Math.floor(Math.random() * 360);
		// random angle plus velocity
		velocity = vectorFromAngleAndVector({x:0, y:0, z:randomAngle}, {x:0, y:10, z:0});
		
		this.position = {x:position.x, y:position.y, z:position.z};
		this.velocity = {x:velocity.x, y:velocity.y, z:velocity.z};
		this.angleDegrees = {x:0, y:0, z:0};
		this.angularVelocity = {x:40, y:0, z:40};
	}
	else if (size === "Medium" || size === "Small")
	{
		// Create a window of 60 degrees then add the index and 120 to them to space the angles apart
		randomAngle = Math.floor(Math.random() * 60);
		randomAngle = randomAngle + (index1 * 120);
		
		velocity = vectorFromAngleAndVector({x:0, y:0, z:randomAngle}, {x:0, y:10, z:0});
		
		if (size === "Medium")
		{
			newPosition = vectorFromAngleAndVector({x:0, y:0, z:randomAngle}, {x:0, y:4, z:0});
		}
		else if (size === "Small")
		{
			newPosition = vectorFromAngleAndVector({x:0, y:0, z:randomAngle}, {x:0, y:2, z:0});
		}
		
		newPosition.x += position.x;
		newPosition.y += position.y;
		newPosition.z += position.z;
		
		// This repositions the newPosition if the rock starts outside the rock wall
		if (40 < newPosition.x + this.radius) // right
		{
			newPosition.x = 40 - this.radius;
		}
		else if (-40 > newPosition.x - this.radius) // left
		{
			newPosition.x = 40 + this.radius;
		}
		
		if (40 < newPosition.y + this.radius) // top
		{
			newPosition.y = 40 - this.radius;
		}
		else if (-40 > newPosition.y + this.radius) // bottom
		{
			newPosition.y = 40 + this.radius;
		}
		
		this.position = {x:newPosition.x, y:newPosition.y, z:newPosition.z};
		this.velocity = {x:velocity.x, y:velocity.y, z:velocity.z};
		this.angleDegrees = {x:0, y:0, z:0};
		this.angularVelocity = {x:40, y:0, z:40};
	}
}

Rock.prototype.updateGraphics = function(gl, world, shaderProgram, projectionMatrix, showCollision)
{
	var modelViewProjectionMatrix = mat4.create();
	var modelViewMatrix = mat4.create();
	var rotationMatrix = mat4.create();

	gl.enableVertexAttribArray(shaderProgram.a_Position);
	gl.enableVertexAttribArray(shaderProgram.a_Normal);

	mat4.identity(modelViewMatrix);
	
	mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0,-15]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-65), [1, 0, 0]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-world.angleDegrees.z), [0, 0, 1]);
	mat4.translate(modelViewMatrix, modelViewMatrix, [-world.position.x,-world.position.y, 0]);
	
	mat4.translate(modelViewMatrix, modelViewMatrix, [this.position.x, this.position.y, this.position.z]); //modelViewMatrix.translate(object.position.x, object.position.y, 0);
	
	mat4.rotate(rotationMatrix, modelViewMatrix, radiansFromDegrees(this.angleDegrees.z), [0, 0, 1]); //rotationMatrix.rotate(object.rotation, 0, 0, 1);
	mat4.rotate(rotationMatrix, rotationMatrix, radiansFromDegrees(this.angleDegrees.x), [1, 0, 0]); //rotationMatrix.rotate(object.rotation, 1, 0, 0);
	
	mat4.multiply(modelViewProjectionMatrix, projectionMatrix, rotationMatrix);
	
	gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
	gl.uniformMatrix4fv(shaderProgram.u_ModelViewMatrix, false, modelViewMatrix);
	gl.uniformMatrix4fv(shaderProgram.u_RotationMatrix, false, rotationMatrix);
	
	gl.uniform1f(shaderProgram.u_Radius, this.rockObject.radius);
	gl.uniform1i(shaderProgram.u_Lighting, this.rockObject.lighting);
	gl.uniform1i(shaderProgram.u_Texture, this.rockObject.texture);
	gl.uniform4f(shaderProgram.u_Color, 0.7, 0.5, 0.3, 1);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.rockObject.vertexBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ARRAY_BUFFER, this.rockObject.normalBuffer);
	gl.vertexAttribPointer(shaderProgram.a_Normal, 3, gl.FLOAT, false, 0, 0);
	
	gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.rockObject.indexBuffer);
	gl.drawElements(gl.TRIANGLES, this.rockObject.indexLength, gl.UNSIGNED_SHORT, 0);
	
	gl.disableVertexAttribArray(shaderProgram.a_Position);
	gl.disableVertexAttribArray(shaderProgram.a_Normal);
	
	if (showCollision)
	{
		gl.enableVertexAttribArray(shaderProgram.a_Position);
		gl.enableVertexAttribArray(shaderProgram.a_Color);

		mat4.multiply(modelViewProjectionMatrix, projectionMatrix, modelViewMatrix);

		gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
		gl.uniform1f(shaderProgram.u_Radius, this.radius);
		gl.uniform1i(shaderProgram.u_Lighting, false);
		gl.uniform1i(shaderProgram.u_Texture, false);
		gl.uniform4f(shaderProgram.u_Color, 0, 0, 1, 1);
	
		gl.bindBuffer(gl.ARRAY_BUFFER, this.collision.vertexBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
		gl.bindBuffer(gl.ARRAY_BUFFER, this.collision.colorBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Color, 4, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.collision.indexBuffer);
		gl.drawElements(gl.TRIANGLES, this.collision.indexLength, gl.UNSIGNED_SHORT, 0);
		
		gl.disableVertexAttribArray(shaderProgram.a_Position);
		gl.disableVertexAttribArray(shaderProgram.a_Color);
	}
}

function WaterBlast(gl, position, angleDegrees)
{
	var index1;
	var particle;
	
	this.radius = 0.3; // The collision radius
	this.collision = createRoundedSquare(gl, this.radius + 0.5);
	this.position = position;//{x:0, y:0, z:0};
	this.angleDegrees = angleDegrees;//{x:0, y:0, z:0};
	this.active = true;

	this.waterParticles = [];
	
	for (index1 = 0; index1 < 10; index1++)
	{
		particle =
		{
			radius:0.1,
			speed:(Math.random() * 10) - 20,
			position:0,
			angleDegrees:(Math.random() * 10) - 5,
			water:createRoundedSquare(gl, 0.1),
			colorPosition:1,
			colorSpeed:-3
		};
		
		this.waterParticles.push(particle);
	}
}

WaterBlast.prototype.updateGraphics = function(gl, world, shaderProgram, projectionMatrix, timeStep, showCollision)
{
	var modelViewProjectionMatrix = mat4.create();
	var modelViewMatrix = mat4.create();
	var waterViewMatrix = mat4.create();
	var particle;
	var scale;
	var index1;

	gl.enableVertexAttribArray(shaderProgram.a_Position);
	gl.enableVertexAttribArray(shaderProgram.a_Color);
	
	mat4.identity(modelViewMatrix);
	
	mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0,-15]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-65), [1, 0, 0]);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(-world.angleDegrees.z), [0, 0, 1]);
	mat4.translate(modelViewMatrix, modelViewMatrix, [-world.position.x,-world.position.y, 0]);
	mat4.translate(modelViewMatrix, modelViewMatrix, [this.position.x, this.position.y, this.position.z]); //modelViewMatrix.translate(object.position.x, object.position.y, 0);
	mat4.rotate(modelViewMatrix, modelViewMatrix, radiansFromDegrees(this.angleDegrees.z), [0, 0, 1]); //modelViewMatrix.rotate(waterBlast.angleDegrees.z, 0, 0, 1);

	for (index1 = 0; index1 < this.waterParticles.length; index1++)
	{
		particle = this.waterParticles[index1];
		
		particle.position += particle.speed * timeStep;
		particle.colorPosition += particle.colorSpeed * timeStep;
		
		//mat4.rotate(waterViewMatrix, modelViewMatrix, radiansFromDegrees(0), [0, 0, 1]); //modelViewMatrix.rotate(waterBlast.angleDegrees.z, 0, 0, 1);
		// The angle in degrees in a cricle around the starting point
		mat4.rotate(waterViewMatrix, modelViewMatrix, radiansFromDegrees(particle.angleDegrees), [0, 0, 1]); //modelViewMatrix.rotate(waterBlast.angleDegrees.y, 0, 1, 0);
		// The angle in degrees that draws the particle out from the center point
		//mat4.rotate(waterViewMatrix, waterViewMatrix, radiansFromDegrees(0), [1, 0, 0]); //modelViewMatrix.rotate(5, 1, 0, 0);
		mat4.translate(waterViewMatrix, waterViewMatrix, [0, particle.position, 0]); // modelViewMatrix.translate(0, waterBlast.position.y, 0);
		mat4.flattenSpherically(waterViewMatrix, waterViewMatrix);
		
		mat4.multiply(modelViewProjectionMatrix, projectionMatrix, waterViewMatrix);
		
		gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
		gl.uniform1f(shaderProgram.u_Radius, particle.radius);
		gl.uniform1i(shaderProgram.u_Lighting, particle.water.lighting);
		gl.uniform1i(shaderProgram.u_Texture, particle.water.texture);
		gl.uniform4f(shaderProgram.u_Color, 0, particle.colorPosition, 1, 1);
		
		gl.bindBuffer(gl.ARRAY_BUFFER, particle.water.vertexBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ARRAY_BUFFER, particle.water.colorBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Color, 4, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, particle.water.indexBuffer);
		gl.drawElements(gl.TRIANGLES, particle.water.indexLength, gl.UNSIGNED_SHORT, 0);
		
		if (particle.position < -3)
		{
			particle.position = 0;
			particle.colorPosition = 1;
		}
	}
	
	gl.disableVertexAttribArray(shaderProgram.a_Position);
	gl.disableVertexAttribArray(shaderProgram.a_Color);
	
	if (showCollision)
	{
		gl.enableVertexAttribArray(shaderProgram.a_Position);
		gl.enableVertexAttribArray(shaderProgram.a_Color);
		
		mat4.multiply(modelViewProjectionMatrix, projectionMatrix, modelViewMatrix);

		gl.uniformMatrix4fv(shaderProgram.u_MvpMatrix, false, modelViewProjectionMatrix);
		gl.uniform1f(shaderProgram.u_Radius, this.radius);
		gl.uniform1i(shaderProgram.u_Lighting, false);
		gl.uniform1i(shaderProgram.u_Texture, false);
		gl.uniform4f(shaderProgram.u_Color, 0, 0, 1, 1);
	
		gl.bindBuffer(gl.ARRAY_BUFFER, this.collision.vertexBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Position, 3, gl.FLOAT, false, 0, 0);
	
		gl.bindBuffer(gl.ARRAY_BUFFER, this.collision.colorBuffer);
		gl.vertexAttribPointer(shaderProgram.a_Color, 4, gl.FLOAT, false, 0, 0);
		
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.collision.indexBuffer);
		gl.drawElements(gl.TRIANGLES, this.collision.indexLength, gl.UNSIGNED_SHORT, 0);
		
		gl.disableVertexAttribArray(shaderProgram.a_Position);
		gl.disableVertexAttribArray(shaderProgram.a_Color);
	}
}

// Below is taken from the "Game Physics Cookbook" Yum!
function checkLineToCircleCollision(line, circle)
{
	var ab = {};
	var t;
	var lineToCenter = {};
	var closestPoint = {};
	var circleToClosest = {};
	var length;
	
	ab.x = line.end.x - line.start.x;
	ab.y = line.end.y - line.start.y;
	
	lineToCenter.x = circle.position.x - line.start.x
	lineToCenter.y = circle.position.y - line.start.y;
		
	t = dotProduct2D(lineToCenter, ab) / dotProduct2D(ab, ab);
	
	if (t < 0 || t > 1)
	{
		return false;
	}
	
	closestPoint.x = line.start.x + ab.x * t;
	closestPoint.y = line.start.y + ab.y * t;
	
	circleToClosest.start = {x:circle.position.x, y:circle.position.y};
	circleToClosest.end = {x:closestPoint.x, y:closestPoint.y};
	
	length = lengthSq2D(circleToClosest) < circle.radius * circle.radius;
	
	return length;
}

function checkCircleToCircleCollision(circle1, circle2)
{
	var line = {};
	var radiiSum;
	var length;
	
	line.start = {x:circle1.position.x, y:circle1.position.y};
	line.end = {x:circle2.position.x, y:circle2.position.y};
	
	radiiSum = circle1.radius + circle2.radius;
	length = lengthSq2D(line) <= radiiSum * radiiSum;
	
	return length;
}

function vectorFromAngleAndVector(angularDegrees, linearVelocity)
{
	var angleRadians = angularDegrees.z * Math.PI / 180.0;
	var linearVector = {};
	
	linearVector.x = linearVelocity.x * Math.cos(angleRadians) - linearVelocity.y * Math.sin(angleRadians);
	linearVector.y = linearVelocity.x * Math.sin(angleRadians) + linearVelocity.y * Math.cos(angleRadians);
	linearVector.z = linearVelocity.z;
	
	return linearVector;
}

function lengthSq2D(line)
{
	var lineSegment = {x:line.end.x - line.start.x, y:line.end.y - line.start.y};
	var magnitude = magnitudeSq2D(lineSegment);
	
	return magnitude;
}

function magnitudeSq2D(vector)
{
	var dot = dotProduct2D(vector, vector);
	
	return dot;
}

function dotProduct2D(vector1, vector2)
{
	return vector1.x * vector2.x + vector1.y * vector2.y;
}
